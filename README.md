# Лабораторная работа №1
## Применение дизассемблеров для анализа вредоносного ПО

**Выполнили:** Ульмашев Ислам Русланович, Духнай Николай Евгеньевич  
**Дисциплина:** «Защита программного обеспечения защищенных автоматизированных систем»

---

### Задачи работы

1.  Изучить базовый функционал дизассемблера IDA Pro.
2.  Найти и скачать относительно свежий образец вредоносного ПО (ВПО) из открытого источника.
3.  Провести его статический анализ с помощью IDA Pro.
4.  Примерно разобраться в структуре файла, принципах его работы и выявить признаки вредоносности.

---

### Ход работы

#### 1. Получение и подготовка исследуемого образца

Образец был загружен из открытого репозитория **vx-underground.org** (раздел: **Samples → Families → BitRAT**).

Файл был скачан в формате архива `.7z`. Для распаковки использован стандартный для подобных архивов пароль **`infected`**. После распаковки получен исполняемый файл. В ходе анализа для идентификации используется его хэш SHA-256.

*   **SHA-256 образца:** `bc79384d3ac2cd1b31856ee88eb478635d9145124aa9a93dcaa6415360c356f1`

Анализ проводился на изолированной виртуальной машине (сеть отключена) с использованием **IDA Pro 9.2**.

#### 2. Статический анализ в IDA Pro

##### 2.1. Анализ таблицы импорта (Imports)

Анализ импортируемых функций показал крайне скудный и специфичный набор:

**Основные импортируемые библиотеки:**
*   `kernel32.dll`
    *   `GetModuleHandleA`
    *   `LoadLibraryA`
    *   `GetProcAddress`
*   `msvcrt.dll` (стандартная библиотека C Runtime)

**Вывод:** Такой минималистичный список, состоящий в основном из функций для динамической загрузки библиотек (`LoadLibraryA`, `GetProcAddress`), является классическим индикатором **упакованного или обфусцированного исполняемого файла**. Фактический вредоносный код, скорее всего, получает доступ к необходимым API-функциям Windows не через статический импорт, а путем их динамического поиска в памяти во время выполнения.

##### 2.2. Анализ точки входа и функции start

Точка входа программы (`start`) расположена по адресу `0x00C1C18B`. Код в этой области не соответствует типичной логике приложения, а представляет собой **распаковщик (unpacker stub)**.

**Наблюдаемый алгоритм в начале функции `start`:**
mov dl, [esi]
inc esi
adc dl, dl
...
adc eax, eax
add dl, dl
jnz short loc_C1C226
Данная последовательность инструкций — характерный признак **алгоритма распаковки, основанного на LZ-семействе** (например, LZ77). Операции `adc` (add with carry) типичны для обработки сжатых битовых потоков в таких алгоритмах.

##### 2.3. Анализ строк (Strings)

Анализ строковых констант в файле (Shift+F12) **не выявил читаемых артефактов**: отсутствуют URL C2-серверов, пути к файлам, строки конфигурации или отладочные сообщения.

**Вывод:** Полное отсутствие читаемых строк — прямое следствие применения обфускации и подтверждает факт упаковки, скрывающей логику вредоноса от статического анализа.

##### 2.4. Ключевая находка: точка передачи управления

В теле функции распаковщика была обнаружена критическая инструкция по адресу `0x00C1C265`:

`jmp eax`

**Интерпретация:** После завершения цикла распаковки регистр `EAX`, с высокой вероятностью, содержит базовый адрес **распакованного в память основного тела вредоносной программы**. Инструкция `jmp eax` выполняет передачу управления на этот код. Это стандартный финальный этап работы упаковщика: нативный код-загрузчик размещает полезную нагрузку (payload) в памяти и переходит на её выполнение.

#### 3. Выводы по результатам анализа

1.  **Факт упаковки:** Исследуемый файл является **упакованным (packed)**. На это однозначно указывают: минимальный набор импортов, наличие кода алгоритма распаковки в точке входа и отсутствие читаемых строк.
2.  **Идентификация:** Исходя из источника загрузки (папка BitRAT), образец можно отнести к семейству **троянов удалённого доступа (RAT) BitRAT**.
3.  **Принцип работы:** Файл действует по схеме **загрузчика (loader)**. Его видимая нативная часть не содержит вредоносной логики, а только выполняет распаковку и запуск скрытой основной полезной нагрузки. Вся функциональность RAT (связь с C2-сервером, кража данных, persistence) содержится в этом зашифрованном payload.

**Итог:** В ходе работы были освоены базовые приемы статического анализа в IDA Pro, изучены методы идентификации упакованного кода и проанализирован механизм работы распаковщика на актуальном примере современного вредоносного ПО.
